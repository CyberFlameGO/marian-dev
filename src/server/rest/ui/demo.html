<html>
  <head>
    <meta charset="UTF-8">
    <script language="javascript" type="text/javascript">

      function go() {
          document.getElementById('translation').innerHTML = "";
          var input = document.getElementById("input").value;
          input.replace(/\n/g,"\\n");
          var job = new XMLHttpRequest();
          job.open("POST","http://{{URL}}/api/elg/v1");
          job.setRequestHeader("Content-Type","application/json");
          job.onreadystatechange = function () {
              if (this.readyState === this.DONE) {
                  // console.log(this.responseText);
                  var response = JSON.parse(this.responseText);
                  var msg;
                  if (response.failure) {
                      msg = "<b>ERROR</b><br>" + response.errors.join("<br>");
                  }
                  else{
                      msg = response.response.texts[0]["text"].replace(/\n/g,"<br>\n");
                  }
                  document.getElementById('translation').innerHTML = msg;
                  // document.getElementById('response').innerHTML = this.responseText;
              }
          }
          var payload = { "metadata" : { "id": 0 },
                          "request"  : { "type" : "text",
                                         "mimeType" : "text/plain",
                                         "characterEncoding" : "UTF-8",
                                         "content" : input}};
          job.send(JSON.stringify(payload));
          document.getElementById('input').focus();
      }

      function clearContent() {
          document.getElementById('input').value = "";
          document.getElementById('translation').innerHTML = "";
          document.getElementById('input').focus();
      }

    </script>
  </head>
  <body>
    <h1>Translation Demo ({{URL}})</h1>
    <p style="color:gray">Enter a new sentence or edit the sentence in the box,
      press [Enter] or click [Translate] to translate. Have fun!</p>
    <input id="input" size="200" oninput="document.getElementById('translation').innerHTML='';"
           value="Dieses Kamel ißt gerne Kartoffelsalat mit Wiener Würstchen, während es im Bett liegt und Fernsehen schaut."></input><br>
    <button onclick="clearContent()">clear</button>
    <button id="go" onclick="go()">translate</button>
    <!-- <h2>Response:</h2>
         <div id="response"></div> -->
    <h2>Translation:</h2>
    <div id="translation"></div>

    <script language="javascript" type="text/javascript">
      document.getElementById("input").focus();
      document.getElementById("input").addEventListener("keyup",function(ev) {
      if (ev.keyCode == 13) {
      ev.preventDefault();
      this.focus();
      go();
      }});
    </script>
  </body>
</html>
